# Raspberry Pi Sense HAT Emulator
#### Try a RPi before you buy!
As you know we will be using a Raspberry Pi in the latter part of the module to explore wireless networking and "device-level" connected applications. You will need to buy a Raspberry pi and Sense HAT to complete and assignments and labs.
The Sense HAT(Hardware Attached on Top), the multi-purpose add-on board for the Raspberry Pi that contains various sensors and an array of RGB LEDs. IT was also sent into space as part of the Astro Pi project on the International Space Station.
![Sense HAT](./img/sensehat.jpg)

However, we don't need the Pi and Sense Hat to start working with it. A US-based start-up called Trinket with Raspberry Pi have developed a web-based emulator for Sense Hat. The emulator is a useful development tool as it allows you to test, debug and share applications without putting them on an actual device (you will probably use an emulator for your Mobile App Dev module).  

![Sense HAT Emulator](./img/sensehatemulator.png)  

### Programming the Emulator
The emulator uses a programming language called Python. You have probably not come across Python before but you do have knowledge of programming now and we will use Trinket to "hack" an existing code example. Try the following with Trinket:

+ Open the following Sensor Hat template in Trinket: <a href="https://trinket.io/library/trinkets/eb497f6d45" target="_blank">https://trinket.io/library/trinkets/eb497f6d45</a>
+ Have a close look at the script and try to deduce what's going to happen when you run it.
+ Run the example by clicking the run button.

As you can see, it prints the message across the LEDs. See if you can change the program to:

+ print you name instead of "Hello World"
+ change the colour to red.

### Environment Data
The Sense HAT has temperature, pressure and humidity sensors. Notice that the emulator has sliders you can move to change these values.

![Sense Hat](./img/sliders.png)  

Now use the temperature sensor on the board to make a kind of "smart" thermostat. Check out the following example that uses the temperature sensor: <a href="https://trinket.io/library/trinkets/cceba5489f" target="_blank">https://trinket.io/library/trinkets/cceba5489f</a>

 Run the example and you'll see the temperature printed in the lower console output window. Let's combine modify this simple example to use the temperature to do the following:

 - If the temperature greater than or equal to 25C print "HOT!" on the Sense Hat, otherwise print "Fine!" in green(i.e if it's below 25C).

In the trinket temperature example, replace the code in main.py with the following:  

```python
from sense_hat import SenseHat

sense = SenseHat()
sense.clear()
green = (0, 255, 0)
red = (255,0,0)
while True:
  temp = sense.get_temperature()
  if temp >=25:
    sense.show_message("HOT!", text_colour = red)
  else:
    sense.show_message("Fine!", text_colour = green)
  print(temp)

```

Now we are using an environment variable (temperature) in our program to make a decision(i.e. decide if it's hot or not) and visually indicating this using the Sense Hat.

## Internet of Things
This is a networking module so now lets stick some networking into the program and connect our emulated device to the internet.
Let's presume this device is part of a network of environment sensors that need to send their data to a central messaging service.  
In this example, we will send our data to a "channel" on the [Thingspeak](https://thingspeak.com/) platform. We can do this by sending a HTTP request with an encoded URL. This is similar to what you did in Web Dev with HTML forms except we're doing it programmatically using Python.

Update your program with the following code:

~~~ Python
from sense_hat import SenseHat
import urllib.request
import time


sense = SenseHat()
sense.clear()
green = (0, 255, 0)
red = (255,0,0)
#You'll need to update the following statement...
serviceurl = 'https://api.thingspeak.com/update?field1=YOUR_DEVICE_NAME&api_key=USE_YOUR_OWN_OR_GET_IT_IN_CLASS>'

while True:
  temp = sense.get_temperature()
  url = serviceurl + '&field2='+str(temp)
  if temp >=25:
    sense.show_message("HOT!", text_colour = red)
  else:
    sense.show_message("Fine!", text_colour = green)    
  urllib.request.urlopen(url)
  time.sleep(5)
  print(temp)
~~~

Replace the *YOUR_DEVICE_NAME* with a unique name of your device (I'll leave that up to you) and replace *USE_YOUR_OWN_OR_GET_IT_IN_CLASS* with the api key given in class.

## Want to do more...

Create an account at [https://thingspeak.com/](https://thingspeak.com/) and set up your own channel to receive data from your device.
